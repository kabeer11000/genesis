# Protein Classification System

## Overview

This is a complete C++ implementation of a protein classification system based on genetic algorithms and function generation, as described in the research diagram. The system uses evolutionary computation to generate and optimize functions for protein classification.

## System Architecture

### Core Components

1. **Protein Class** (`protein.h/cpp`)
   - Represents individual protein sequences
   - Calculates basic biochemical properties:
     - Hydrophobicity (based on amino acid properties)
     - Molecular weight
     - Charge at pH 7
     - Amino acid composition

2. **Function System** (`functions.h/cpp`)
   - **Fixed Functions**: Base functions (f1, f2, f3)
     - `f1`: Hydrophobicity-based function
     - `f2`: Length-normalized function  
     - `f3`: Charge density function
   - **Dynamic Functions**: Generated combinations of fixed functions
   - **Function Tables**: Intermediate representation for each protein

3. **Database** (`database.h/cpp`)
   - Manages protein collections
   - 4 known proteins with classifications
   - 1 test protein for validation
   - Statistical analysis capabilities

4. **Classifier** (`classifier.h/cpp`)
   - Trains using evolutionary weight optimization
   - Uses function tables for classification
   - Provides confidence scores
   - Tests on unknown proteins

5. **Generator** (`generator.h/cpp`)
   - Population-based function generation
   - Chromosome evolution (population size = 200)
   - Function combination and mutation
   - Fitness evaluation and selection

## Algorithm Flow

### Phase 1: Initialization
1. Load protein database (4 known + 1 test protein)
2. Initialize fixed functions (f1, f2, f3)
3. Compute basic protein properties

### Phase 2: Function Generation
1. Generate population of 200 functions
2. Create dynamic functions by combining base functions
3. Evolve chromosome through genetic operations
4. Select best functions based on discriminative power

### Phase 3: Function Table Creation
For each protein X, create table:
```
f_1(X) = value_1
f_2(X) = value_2  
...
f_N(X) = value_N
```

### Phase 4: Classification Training
1. Select subset of best functions
2. Initialize random weights
3. Evolve weights using genetic algorithm
4. Optimize for 90% accuracy threshold

### Phase 5: Testing
1. Apply trained classifier to test proteins
2. Generate confidence scores
3. Provide classification results

## Technical Implementation

### Data Structures
- **Proteins**: Stored as amino acid sequences with metadata
- **Functions**: Stored as std::function objects with string identifiers
- **Tables**: std::map<string, double> for function values
- **Chromosome**: std::vector<string> of function names

### Key Algorithms
- **Hydrophobicity Calculation**: Uses standard amino acid hydrophobicity scale
- **Function Evolution**: Random combination with genetic operations
- **Weight Optimization**: Gradient-free evolutionary strategy
- **Classification**: Weighted sum with sigmoid normalization

### Logging System
All operations are extensively logged:
- Function creation and evaluation
- Database operations
- Training progress
- Classification results

## Database Description

### Known Proteins
1. **Insulin_A** (hormone): Insulin A chain sequence
2. **Insulin_B** (hormone): Insulin B chain sequence  
3. **Elastin** (structural): Elastin peptide sequence
4. **Histone_H4** (regulatory): Histone H4 peptide sequence

### Test Protein
- **Unknown_Test**: Novel sequence for classification testing

## Function Definitions

### Fixed Functions
- **f1_hydrophobicity**: `|hydrophobicity| * 10`
- **f2_length_normalized**: `(length/100) * 20`
- **f3_charge_density**: `|charge|/length * 100`

### Dynamic Functions
Generated by combining fixed functions:
- Addition: `f1 + f2`
- Multiplication: `f1 * f2 * 0.1` (scaled)
- Subtraction: `|f1 - f2|`
- Average: `(f1 + f2) * 0.5`

## Build and Run

### Prerequisites
- C++17 compatible compiler (g++)
- Make utility
- Unix-like environment

### Building
```bash
make all        # Build the project
make run        # Build and run
make clean      # Clean build files
make debug      # Build with debug symbols
```

### Output
The program generates:
- Detailed execution logs
- Function tables for all proteins
- Classification results
- Performance metrics

## Example Output

```
=== Function Table for Insulin_A ===
             f1 : 15.670
             f2 : 9.400
             f3 : 4.255
     dynamic_1 : 25.070
     dynamic_2 : 147.298
===============================

=== Testing on Unknown Proteins ===
Protein: Unknown_Test
Predicted class: structural
Confidence score: 0.742
---
```

## Performance Characteristics

- **Accuracy**: Targets 90% on training set
- **Population Size**: 200 functions (configurable)
- **Evolution Generations**: 50 for functions, 50 for weights
- **Processing Speed**: Real-time for small protein sets
- **Memory Usage**: Minimal (all data in memory)

## Extensibility

### Adding New Proteins
```cpp
database.addProtein(Protein("SEQUENCE", "NAME", "CLASS"));
```

### Adding New Functions
```cpp
ProteinFunctions::fixedFunctions["f4"] = [](const Protein& p) {
    return custom_calculation(p);
};
```

### Modifying Classification
- Adjust threshold in classifier
- Add new protein classes
- Modify fitness function in generator

## Scientific Basis

This implementation follows established bioinformatics principles:
- **Amino Acid Properties**: Uses experimentally determined scales
- **Protein Classification**: Based on structural/functional categories
- **Evolutionary Computation**: Standard genetic algorithm approaches
- **Feature Engineering**: Automated function generation

## Limitations and Future Work

### Current Limitations
- Simple protein database (4 proteins)
- Basic amino acid properties only
- Limited classification categories
- No secondary structure analysis

### Potential Improvements
- Larger protein databases
- Advanced biochemical properties
- Deep learning integration
- Real-time protein structure prediction
- Multi-class classification

## Troubleshooting

### Common Issues
1. **Build Errors**: Ensure C++17 support
2. **Missing Logs**: Check permissions for logs directory
3. **Poor Classification**: Increase evolution generations
4. **Memory Issues**: Reduce population size

### Debug Mode
```bash
make debug
gdb ./protein_classifier
```

## References

This implementation is based on:
- Genetic algorithms for protein classification
- Evolutionary function generation
- Biochemical property scales
- Machine learning classification techniques

---

**Note**: This is a simplified educational implementation. For production bioinformatics applications, consider using established libraries like BioPython, BLAST, or specialized protein analysis tools.
